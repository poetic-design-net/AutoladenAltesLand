---
import PageLayout from '../layouts/PageLayout.astro';

// Get current German time for online status
const now = new Date();
const germanTime = new Date(now.toLocaleString("en-US", {timeZone: "Europe/Berlin"}));
const hours = germanTime.getHours();
const day = germanTime.getDay();

// Check if Alex is online
const isOnline = 
  (day >= 1 && day <= 5 && hours >= 9 && hours < 17) || 
  (day === 6 && hours >= 9 && hours < 14);

const kontaktData = {
  firmenname: "Autoladen Altes Land",
  strasse: "Hauptstraße 123",
  plz: "21720",
  ort: "Grünendeich",
  telefon: "+49 162 123 4567",
  email: "info@autoladen-altesland.de",
  oeffnungszeiten: [
    { tag: "Mo-Fr", zeit: "9:00 - 17:00 Uhr" },
    { tag: "Sa", zeit: "9:00 - 14:00 Uhr" },
    { tag: "So", zeit: "Geschlossen" }
  ]
};
---

<PageLayout title="Kontakt - Autoladen Altes Land">
  <div class="bg-gradient-to-br from-white via-gray-50 to-brand-green/5 pb-12">
    <!-- Hero Section -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pt-20 mb-12">
      <div class="text-center">
        <h1 class="text-4xl md:text-5xl font-bold text-gray-900 mb-4">Lass uns schnacken!</h1>
        
        <!-- Handwritten subtitle -->
        <p class="text-2xl text-gray-700 mb-2" style="font-family: 'Caveat', cursive; transform: rotate(-1deg); display: inline-block;">
          "Ehrlich, fair & unkompliziert"
        </p>
        
        <p class="text-xl text-gray-600 mt-4">
          {isOnline ? 'Ich bin gerade online und freue mich auf deine Nachricht!' : 'Ich bin gerade nicht im Büro, antworte dir aber schnellstmöglich!'}
        </p>
        
        <!-- Quick contact badges -->
        <div class="flex flex-wrap justify-center gap-4 mt-8">
          <a 
            href="tel:+491621234567" 
            class="inline-flex items-center gap-2 px-6 py-3 bg-white rounded-full shadow-md hover:shadow-lg transition-all duration-200 hover:-translate-y-0.5"
          >
            <svg class="w-5 h-5 text-brand-green" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path>
            </svg>
            <span class="font-medium">Direkt anrufen</span>
          </a>
          
          <a 
            href="https://wa.me/491621234567" 
            target="_blank"
            class="inline-flex items-center gap-2 px-6 py-3 bg-green-500 text-white rounded-full shadow-md hover:shadow-lg transition-all duration-200 hover:-translate-y-0.5 hover:bg-green-600"
          >
            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
              <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.149-.67.149-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.074-.297-.149-1.255-.462-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.297-.347.446-.521.151-.172.2-.296.3-.495.099-.198.05-.372-.025-.521-.075-.148-.669-1.611-.916-2.206-.242-.579-.487-.501-.669-.51l-.57-.01c-.198 0-.52.074-.792.372s-1.04 1.016-1.04 2.479 1.065 2.876 1.213 3.074c.149.198 2.095 3.2 5.076 4.487.709.306 1.263.489 1.694.626.712.226 1.36.194 1.872.118.571-.085 1.758-.719 2.006-1.413.248-.695.248-1.29.173-1.414-.074-.123-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"/>
            </svg>
            <span class="font-medium">WhatsApp Chat</span>
          </a>
          
          <a 
            href="mailto:info@autoladen-altesland.de" 
            class="inline-flex items-center gap-2 px-6 py-3 bg-white rounded-full shadow-md hover:shadow-lg transition-all duration-200 hover:-translate-y-0.5"
          >
            <svg class="w-5 h-5 text-brand-green" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path>
            </svg>
            <span class="font-medium">E-Mail schreiben</span>
          </a>
        </div>
      </div>
    </div>
    
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="grid lg:grid-cols-3 gap-8">
        <!-- Kontaktformular - Now spans 2 columns -->
        <div class="lg:col-span-2 bg-white rounded-2xl shadow-lg p-8">
          <div class="flex items-center gap-3 mb-6">
            <div class="relative">
              <img 
                src="/alex.jpg" 
                alt="Alex Phillipowski"
                class="w-16 h-16 rounded-full object-cover ring-2 ring-brand-green ring-offset-2"
              />
              <div class={`absolute -bottom-1 -right-1 w-5 h-5 rounded-full border-2 border-white ${isOnline ? 'bg-green-500 animate-pulse' : 'bg-yellow-500'}`}></div>
            </div>
            <div>
              <h2 class="text-2xl font-semibold text-gray-900">Schreib mir direkt</h2>
              <p class="text-sm text-gray-600">Ich antworte persönlich auf jede Nachricht</p>
            </div>
          </div>
          
          <form id="contact-form" class="space-y-4">
            <div class="grid md:grid-cols-2 gap-4">
              <div>
                <label for="name" class="block text-sm font-medium text-gray-700 mb-1">Dein Name</label>
                <input 
                  type="text" 
                  id="name" 
                  name="name" 
                  class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-brand-green focus:border-transparent transition-all duration-200"
                  required
                />
              </div>
              
              <div>
                <label for="phone" class="block text-sm font-medium text-gray-700 mb-1">Telefon (optional)</label>
                <input 
                  type="tel" 
                  id="phone" 
                  name="phone" 
                  class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-brand-green focus:border-transparent transition-all duration-200"
                  placeholder="Für Rückfragen"
                />
              </div>
            </div>
            
            <div>
              <label for="email" class="block text-sm font-medium text-gray-700 mb-1">E-Mail</label>
              <input 
                type="email" 
                id="email" 
                name="email" 
                class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-brand-green focus:border-transparent transition-all duration-200"
                required
              />
            </div>
            
            <div>
              <label for="subject" class="block text-sm font-medium text-gray-700 mb-1">Worum geht's?</label>
              <select 
                id="subject" 
                name="subject" 
                class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-brand-green focus:border-transparent transition-all duration-200"
              >
                <option>Allgemeine Anfrage</option>
                <option>Ich suche ein neues Fahrzeug</option>
                <option>Probefahrt vereinbaren</option>
                <option>Service & Wartung</option>
                <option>Wallbox & Ladeinfrastruktur</option>
                <option>Finanzierung & Leasing</option>
              </select>
            </div>
            
            <div>
              <label for="message" class="block text-sm font-medium text-gray-700 mb-1">Deine Nachricht</label>
              <textarea 
                id="message" 
                name="message" 
                rows="5" 
                class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-brand-green focus:border-transparent transition-all duration-200"
                placeholder="Erzähl mir von deinem Anliegen..."
                required
              ></textarea>
            </div>
            
            <button 
              type="submit" 
              id="submit-button"
              class="w-full bg-brand-lightblue text-white py-4 rounded-full font-medium hover:bg-brand-blue transition-all duration-200 shadow-lg hover:shadow-xl disabled:opacity-50 disabled:cursor-not-allowed transform hover:-translate-y-0.5"
            >
              <span id="button-text">Nachricht absenden</span>
              <span id="button-loading" class="hidden">Wird gesendet...</span>
            </button>
            
            <div id="form-message" class="hidden mt-4 p-4 rounded-xl"></div>
          </form>
        </div>
        
        <!-- Sidebar Info -->
        <div class="space-y-6">
          <!-- Opening Hours Card -->
          <div class="bg-white rounded-2xl shadow-lg p-6">
            <h3 class="text-lg font-semibold mb-4 text-gray-900 flex items-center gap-2">
              <svg class="w-5 h-5 text-brand-green" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
              </svg>
              Öffnungszeiten
            </h3>
            <div class="space-y-3">
              {kontaktData.oeffnungszeiten.map((zeit) => (
                <div class="flex justify-between text-sm">
                  <span class="font-medium text-gray-700">{zeit.tag}</span>
                  <span class="text-gray-600">{zeit.zeit}</span>
                </div>
              ))}
            </div>
            
            <!-- Current Status -->
            <div class="mt-4 pt-4 border-t border-gray-100">
              <div class="flex items-center gap-2">
                <span class={`w-3 h-3 rounded-full ${isOnline ? 'bg-green-500 animate-pulse' : 'bg-yellow-500'}`}></span>
                <span class={`text-sm font-medium ${isOnline ? 'text-green-600' : 'text-gray-600'}`}>
                  {isOnline ? 'Jetzt erreichbar' : 'Außerhalb der Öffnungszeiten'}
                </span>
              </div>
            </div>
          </div>
          
          <!-- Location Card -->
          <div class="bg-white rounded-2xl shadow-lg p-6">
            <h3 class="text-lg font-semibold mb-4 text-gray-900 flex items-center gap-2">
              <svg class="w-5 h-5 text-brand-green" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
              </svg>
              Standort
            </h3>
            <address class="not-italic text-sm text-gray-600 space-y-1">
              <p class="font-medium text-gray-900">{kontaktData.firmenname}</p>
              <p>{kontaktData.strasse}</p>
              <p>{kontaktData.plz} {kontaktData.ort}</p>
            </address>
            
            <a 
              href="https://maps.google.com/?q=Hauptstraße+123,+21635+Jork"
              target="_blank"
              class="inline-flex items-center gap-2 mt-4 text-brand-green hover:text-brand-blue transition-colors text-sm font-medium"
            >
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path>
              </svg>
              Route planen
            </a>
          </div>
          
          <!-- Quick Tips -->
          <div class="bg-brand-green/10 rounded-2xl p-6">
            <h3 class="text-lg font-semibold mb-3 text-gray-900">Gut zu wissen</h3>
            <ul class="space-y-2 text-sm text-gray-700">
              <li class="flex items-start gap-2">
                <span class="text-brand-green mt-1">✓</span>
                <span>Kostenlose Erstberatung</span>
              </li>
              <li class="flex items-start gap-2">
                <span class="text-brand-green mt-1">✓</span>
                <span>Probefahrten jederzeit möglich</span>
              </li>
              <li class="flex items-start gap-2">
                <span class="text-brand-green mt-1">✓</span>
                <span>Parkplätze direkt vor der Tür</span>
              </li>
              <li class="flex items-start gap-2">
                <span class="text-brand-green mt-1">✓</span>
                <span>Barrierefrei zugänglich</span>
              </li>
            </ul>
          </div>
        </div>
      </div>
      
      <!-- Map Section -->
      <div class="mt-12 bg-white rounded-2xl shadow-lg overflow-hidden">
        <div class="p-6 border-b border-gray-100">
          <h2 class="text-2xl font-semibold text-gray-900">So findest du mich</h2>
          <p class="text-gray-600 mt-1">Direkt im Herzen des Alten Lands - mit kostenlosen Parkplätzen</p>
        </div>
        <div class="h-96 bg-gray-100 flex items-center justify-center">
          <div class="text-center">
            <svg class="w-16 h-16 text-gray-400 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"></path>
            </svg>
            <p class="text-gray-500">Google Maps Integration</p>
            <a 
              href="https://maps.google.com/?q=Hauptstraße+123,+21635+Jork"
              target="_blank"
              class="inline-flex items-center gap-2 mt-4 px-6 py-3 bg-brand-green text-white rounded-full hover:bg-brand-green/90 transition-colors"
            >
              In Google Maps öffnen
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path>
              </svg>
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
</PageLayout>

<script>
  const form = document.getElementById('contact-form') as HTMLFormElement;
  const submitButton = document.getElementById('submit-button') as HTMLButtonElement;
  const buttonText = document.getElementById('button-text');
  const buttonLoading = document.getElementById('button-loading');
  const formMessage = document.getElementById('form-message');

  form?.addEventListener('submit', async (e) => {
    e.preventDefault();
    
    // Disable button and show loading state
    submitButton.disabled = true;
    buttonText?.classList.add('hidden');
    buttonLoading?.classList.remove('hidden');
    
    // Hide previous messages
    formMessage?.classList.add('hidden');
    
    const formData = new FormData(form);
    
    // Simulate form submission (replace with actual API call)
    setTimeout(() => {
      // Success simulation
      formMessage!.className = 'mt-4 p-4 rounded-xl bg-green-100 text-green-700 border border-green-200';
      formMessage!.innerHTML = '✅ <strong>Danke für deine Nachricht!</strong><br>Ich melde mich schnellstmöglich bei dir.';
      formMessage?.classList.remove('hidden');
      form.reset();
      
      // Reset button state
      submitButton.disabled = false;
      buttonText?.classList.remove('hidden');
      buttonLoading?.classList.add('hidden');
    }, 1500);
  });
</script>